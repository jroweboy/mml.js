if("undefined"===typeof MIDI)var MIDI={}; (function(){var a={},c=0,b=function(b){c++;var e=new Audio,d=b.split(";")[0];e.id="audio";e.setAttribute("preload","auto");e.setAttribute("audiobuffer",!0);e.addEventListener("error",function(){a[d]=!1;c--},!1);e.addEventListener("canplaythrough",function(){a[d]=!0;c--},!1);e.src="data:"+b;document.body.appendChild(e)};MIDI.audioDetect=function(f){if("undefined"===typeof Audio)return f({});var e=new Audio;if("undefined"===typeof e.canPlayType)return f(a);var d=e.canPlayType('audio/ogg; codecs="vorbis"'), d="probably"===d||"maybe"===d,e=e.canPlayType("audio/mpeg"),e="probably"===e||"maybe"===e;if(d||e){d&&b("audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA="); e&&b("audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");var l=(new Date).getTime(),h=window.setInterval(function(){var d=5E3<(new Date).getTime()-l;if(!c||d)window.clearInterval(h),f(a)},1)}else f(a)}})();"undefined"===typeof MIDI&&(MIDI={}); "undefined"===typeof MIDI.Soundfont&&(MIDI.Soundfont={}); (function(){MIDI.loadPlugin=function(d){"function"===typeof d&&(d={callback:d});var e=d.instruments||d.instrument||"acoustic_grand_piano";"object"!==typeof e&&(e=[e]);for(var b=0;b<e.length;b++){var g=e[b];"number"===typeof g&&(e[b]=MIDI.GeneralMIDI.byId[g])}MIDI.soundfontUrl=d.soundfontUrl||MIDI.soundfontUrl||"./soundfont/";MIDI.audioDetect(function(b){var g="",g=c[d.api]?d.api:c[window.location.hash.substr(1)]?window.location.hash.substr(1):window.webkitAudioContext||window.AudioContext?"webaudio": window.Audio?"audiotag":"flash";if(a[g]){var k=d.targetFormat?d.targetFormat:b["audio/ogg"]?"ogg":"mp3";MIDI.lang=g;MIDI.supports=b;a[g](k,e,d)}})};var a={webmidi:function(a,e,b){MIDI.loader&&MIDI.loader.message("Web MIDI API...");MIDI.WebMIDI.connect(b)},flash:function(a,e,b){MIDI.loader&&MIDI.loader.message("Flash API...");DOMLoader.script.add({src:b.soundManagerUrl||"./inc/SoundManager2/script/soundmanager2.js",verify:"SoundManager",callback:function(){MIDI.Flash.connect(e,b)}})},audiotag:function(a, c,h){MIDI.loader&&MIDI.loader.message("HTML5 Audio API...");var g=e({items:c,getNext:function(e){DOMLoader.sendRequest({url:MIDI.soundfontUrl+e+"-"+a+".js",onprogress:f,onload:function(a){b(a.responseText);MIDI.loader&&MIDI.loader.update(null,"Downloading",100);g.getNext()}})},onComplete:function(){MIDI.AudioTag.connect(h)}})},webaudio:function(a,c,h){MIDI.loader&&MIDI.loader.message("Web Audio API...");var g=e({items:c,getNext:function(e){DOMLoader.sendRequest({url:MIDI.soundfontUrl+e+"-"+a+".js", onprogress:f,onload:function(a){b(a.responseText);MIDI.loader&&MIDI.loader.update(null,"Downloading...",100);g.getNext()}})},onComplete:function(){MIDI.WebAudio.connect(h)}})}},c={webmidi:!0,webaudio:!0,audiotag:!0,flash:!0},b=function(a){var e=document.createElement("script");e.language="javascript";e.type="text/javascript";e.text=a;document.body.appendChild(e)},f=function(a){this.totalSize||(this.getResponseHeader("Content-Length-Raw")?this.totalSize=parseInt(this.getResponseHeader("Content-Length-Raw")): this.totalSize=a.total);a=this.totalSize?Math.round(a.loaded/this.totalSize*100):"";MIDI.loader&&MIDI.loader.update(null,"Downloading...",a)},e=function(a){var e={queue:[]},b;for(b in a.items)a.items.hasOwnProperty(b)&&e.queue.push(a.items[b]);e.getNext=function(){if(!e.queue.length)return a.onComplete();a.getNext(e.queue.shift())};setTimeout(e.getNext,1);return e}})();"undefined"===typeof MIDI&&(MIDI={}); (function(){var a=function(a){MIDI.api=a.api;MIDI.setVolume=a.setVolume;MIDI.programChange=a.programChange;MIDI.noteOn=a.noteOn;MIDI.noteOff=a.noteOff;MIDI.chordOn=a.chordOn;MIDI.chordOff=a.chordOff;MIDI.stopAllNotes=a.stopAllNotes;MIDI.getInput=a.getInput;MIDI.getOutputs=a.getOutputs};(function(){var c=null,b=null,f=MIDI.WebMIDI={api:"webmidi"};f.setVolume=function(a,d){b.send([176+a,7,d])};f.programChange=function(a,d){b.send([192+a,d])};f.noteOn=function(a,d,c,f){b.send([144+a,d,c],1E3*f)};f.noteOff= function(a,d,c){b.send([128+a,d,0],1E3*c)};f.chordOn=function(a,d,c,f){for(var g=0;g<d.length;g++)b.send([144+a,d[g],c],1E3*f)};f.chordOff=function(a,d,c){for(var f=0;f<d.length;f++)b.send([128+a,d[f],0],1E3*c)};f.stopAllNotes=function(){for(var a=0;16>a;a++)b.send([176+a,123,0])};f.getInput=function(){return c.getInputs()};f.getOutputs=function(){return c.getOutputs()};f.connect=function(e){a(f);navigator.requestMIDIAccess().then(function(a){c=a;b=c.outputs()[0];e.callback&&e.callback()},function(a){e.api= window.AudioContext||window.webkitAudioContext?"webaudio":window.Audio?"audiotag":"flash";MIDI.loadPlugin(e)})}})();(window.AudioContext||window.webkitAudioContext)&&function(){var c=window.AudioContext||window.webkitAudioContext,b=MIDI.WebAudio={api:"webaudio"},f,e={},d=127,l={},h=function(a,b,e,k,d){var c=MIDI.GeneralMIDI.byName[a],n=c.number,p=b[e];if(!MIDI.Soundfont[a][p])return d(a);var h=MIDI.Soundfont[a][p].split(",")[1],h=Base64Binary.decodeArrayBuffer(h);f.decodeAudioData(h,function(f){for(var h= p;3>h.length;)h+="&nbsp;";"undefined"!==typeof MIDI.loader&&MIDI.loader.update(null,c.instrument+"<br>Processing: "+(e/87*100>>0)+"%<br>"+h);f.id=p;k[e]=f;if(k.length===b.length){for(;k.length;)(f=k.pop())&&(l[n+""+MIDI.keyToNote[f.id]]=f);d(a)}})};b.setVolume=function(a,b){d=b};b.programChange=function(a,b){MIDI.channels[a].instrument=b};b.noteOn=function(a,b,c,k){if(MIDI.channels[a]){var t=MIDI.channels[a].instrument;if(l[t+""+b]){k+=f.currentTime;var m=f.createBufferSource();e[a+""+b]=m;m.buffer= l[t+""+b];m.connect(f.destination);m.gainNode=f.createGain?f.createGain():f.createGainNode();a=c/127*(d/127)*2-1;m.gainNode.connect(f.destination);m.gainNode.gain.value=Math.max(-1,a);m.connect(m.gainNode);m.noteOn?m.noteOn(k||0):m.start(k||0);return m}}};b.noteOff=function(a,b,c){c=(c||0)+f.currentTime;var k=e[a+""+b];if(k){if(k.gainNode){var d=k.gainNode.gain;d.linearRampToValueAtTime(d.value,c);d.linearRampToValueAtTime(-1,c+.2)}k.noteOff?k.noteOff(c+.3):k.stop(c+.3);delete e[a+""+b]}};b.chordOn= function(a,e,c,k){for(var d={},f,n=0,p=e.length;n<p;n++)d[f=e[n]]=b.noteOn(a,f,c,k);return d};b.chordOff=function(a,e,c){for(var k={},d,f=0,n=e.length;f<n;f++)k[d=e[f]]=b.noteOff(a,d,c);return k};b.stopAllNotes=function(){for(var a in e){var b=0;b<f.currentTime&&(b+=f.currentTime);e[a].gain.linearRampToValueAtTime(1,b);e[a].gain.linearRampToValueAtTime(0,b+.2);e[a].noteOff(b+.3);delete e[a]}};b.connect=function(e){a(b);MIDI.Player.ctx=f=new c;var d=[],l=MIDI.keyToNote,k;for(k in l)d.push(k);var l= [],t={};k=function(a){delete t[a];for(var b in t)break;b||e.callback()};for(var m in MIDI.Soundfont){t[m]=!0;for(var n=0;n<d.length;n++)h(m,d,n,l,k)}}}();window.Audio&&function(){for(var c=MIDI.AudioTag={api:"audiotag"},b={},f=127,e=-1,d=[],l=[],h={},g=0;12>g;g++)d[g]=new Audio;var q=function(a,b){if(MIDI.channels[a]){var c=MIDI.GeneralMIDI.byId[MIDI.channels[a].instrument].id;if(b=h[b]){var n=(e+1)%d.length,p=d[n];l[n]=c+""+b.id;p.src=MIDI.Soundfont[c][b.id];p.volume=f/127;p.play();e=n}}},r=function(a, b){if(MIDI.channels[a]){var c=MIDI.GeneralMIDI.byId[MIDI.channels[a].instrument].id;if(b=h[b])for(var c=c+""+b.id,f=0;f<d.length;f++){var p=(f+e+1)%d.length,g=l[p];if(g&&g==c){d[p].pause();l[p]=null;break}}}};c.programChange=function(a,b){MIDI.channels[a].instrument=b};c.setVolume=function(a,b){f=b};c.noteOn=function(a,e,c,d){var f=b[e];if(h[f]){if(d)return window.setTimeout(function(){q(a,f)},1E3*d);q(a,f)}};c.noteOff=function(a,e,c){var d=b[e];if(h[d]){if(c)return setTimeout(function(){r(a,d)}, 1E3*c);r(a,d)}};c.chordOn=function(a,e,c,d){for(c=0;c<e.length;c++){var f=b[e[c]];if(h[f]){if(d)return window.setTimeout(function(){q(a,f)},1E3*d);q(a,f)}}};c.chordOff=function(a,e,c){for(var d=0;d<e.length;d++){var f=b[e[d]];if(h[f]){if(c)return window.setTimeout(function(){r(a,f)},1E3*c);r(a,f)}}};c.stopAllNotes=function(){for(var a=0,b=d.length;a<b;a++)d[a].pause()};c.connect=function(e){for(var d in MIDI.keyToNote)b[MIDI.keyToNote[d]]=d,h[d]={id:d};a(c);e.callback&&e.callback()}}();(function(){var c= MIDI.Flash={api:"flash"},b={},f={};c.programChange=function(a,b){MIDI.channels[a].instrument=b};c.setVolume=function(a,b){};c.noteOn=function(a,c,l,h){if(MIDI.channels[a]&&(c=MIDI.GeneralMIDI.byId[MIDI.channels[a].instrument].number+""+b[c],f[c])){if(h)return window.setTimeout(function(){f[c].play({volume:2*l})},1E3*h);f[c].play({volume:2*l})}};c.noteOff=function(a,b,c){};c.chordOn=function(a,c,l,h){if(MIDI.channels[a]){a=MIDI.GeneralMIDI.byId[MIDI.channels[a].instrument].number;for(var g in c)h= a+""+b[c[g]],f[h]&&f[h].play({volume:2*l})}};c.chordOff=function(a,b,c){};c.stopAllNotes=function(){};c.connect=function(e,d){soundManager.flashVersion=9;soundManager.useHTML5Audio=!0;soundManager.url=d.soundManagerSwfUrl||"../inc/SoundManager2/swf/";soundManager.useHighPerformance=!0;soundManager.wmode="transparent";soundManager.flashPollingInterval=1;soundManager.debugMode=!1;soundManager.onload=function(){for(var h=function(a,b,c){f[MIDI.GeneralMIDI.byName[a].number+""+b]=soundManager.createSound({id:b, url:MIDI.soundfontUrl+a+"-mp3/"+b+".mp3",multiShot:!0,autoLoad:!0,onload:c})},g=[],l=88*e.length,r=0;r<e.length;r++)for(var k=e[r],t=function(){g.push(this.sID);"undefined"!==typeof MIDI.loader&&MIDI.loader.update(null,"Processing: "+this.sID)},m=0;88>m;m++)h(k,b[m+21],t);a(c);var n=window.setInterval(function(){g.length<l||(window.clearInterval(n),d.callback&&d.callback())},25)};soundManager.onerror=function(){};for(var l in MIDI.keyToNote)b[MIDI.keyToNote[l]]=l}})();MIDI.GeneralMIDI=function(a){var b= function(a){return a.replace(/[^a-z0-9 ]/gi,"").replace(/[ ]/g,"_").toLowerCase()},f={byName:{},byId:{},byCategory:{}},e;for(e in a)for(var d=a[e],l=0,h=d.length;l<h;l++){var g=d[l];if(g){var q=parseInt(g.substr(0,g.indexOf(" ")),10),g=g.replace(q+" ","");f.byId[--q]=f.byName[b(g)]=f.byCategory[b(e)]={id:b(g),instrument:g,number:q,category:e}}}return f}({Piano:"1 Acoustic Grand Piano;2 Bright Acoustic Piano;3 Electric Grand Piano;4 Honky-tonk Piano;5 Electric Piano 1;6 Electric Piano 2;7 Harpsichord;8 Clavinet".split(";"), "Chromatic Percussion":"9 Celesta;10 Glockenspiel;11 Music Box;12 Vibraphone;13 Marimba;14 Xylophone;15 Tubular Bells;16 Dulcimer".split(";"),Organ:"17 Drawbar Organ;18 Percussive Organ;19 Rock Organ;20 Church Organ;21 Reed Organ;22 Accordion;23 Harmonica;24 Tango Accordion".split(";"),Guitar:"25 Acoustic Guitar (nylon);26 Acoustic Guitar (steel);27 Electric Guitar (jazz);28 Electric Guitar (clean);29 Electric Guitar (muted);30 Overdriven Guitar;31 Distortion Guitar;32 Guitar Harmonics".split(";"), Bass:"33 Acoustic Bass;34 Electric Bass (finger);35 Electric Bass (pick);36 Fretless Bass;37 Slap Bass 1;38 Slap Bass 2;39 Synth Bass 1;40 Synth Bass 2".split(";"),Strings:"41 Violin;42 Viola;43 Cello;44 Contrabass;45 Tremolo Strings;46 Pizzicato Strings;47 Orchestral Harp;48 Timpani".split(";"),Ensemble:"49 String Ensemble 1;50 String Ensemble 2;51 Synth Strings 1;52 Synth Strings 2;53 Choir Aahs;54 Voice Oohs;55 Synth Choir;56 Orchestra Hit".split(";"),Brass:"57 Trumpet;58 Trombone;59 Tuba;60 Muted Trumpet;61 French Horn;62 Brass Section;63 Synth Brass 1;64 Synth Brass 2".split(";"), Reed:"65 Soprano Sax;66 Alto Sax;67 Tenor Sax;68 Baritone Sax;69 Oboe;70 English Horn;71 Bassoon;72 Clarinet".split(";"),Pipe:"73 Piccolo;74 Flute;75 Recorder;76 Pan Flute;77 Blown Bottle;78 Shakuhachi;79 Whistle;80 Ocarina".split(";"),"Synth Lead":"81 Lead 1 (square);82 Lead 2 (sawtooth);83 Lead 3 (calliope);84 Lead 4 (chiff);85 Lead 5 (charang);86 Lead 6 (voice);87 Lead 7 (fifths);88 Lead 8 (bass + lead)".split(";"),"Synth Pad":"89 Pad 1 (new age);90 Pad 2 (warm);91 Pad 3 (polysynth);92 Pad 4 (choir);93 Pad 5 (bowed);94 Pad 6 (metallic);95 Pad 7 (halo);96 Pad 8 (sweep)".split(";"), "Synth Effects":"97 FX 1 (rain);98 FX 2 (soundtrack);99 FX 3 (crystal);100 FX 4 (atmosphere);101 FX 5 (brightness);102 FX 6 (goblins);103 FX 7 (echoes);104 FX 8 (sci-fi)".split(";"),Ethnic:"105 Sitar;106 Banjo;107 Shamisen;108 Koto;109 Kalimba;110 Bagpipe;111 Fiddle;112 Shanai".split(";"),Percussive:"113 Tinkle Bell;114 Agogo;115 Steel Drums;116 Woodblock;117 Taiko Drum;118 Melodic Tom;119 Synth Drum".split(";"),"Sound effects":"120 Reverse Cymbal;121 Guitar Fret Noise;122 Breath Noise;123 Seashore;124 Bird Tweet;125 Telephone Ring;126 Helicopter;127 Applause;128 Gunshot".split(";")}); MIDI.channels=function(){for(var a={},b=0;16>b;b++)a[b]={instrument:0,mute:!1,mono:!1,omni:!1,solo:!1};return a}();MIDI.pianoKeyOffset=21;MIDI.keyToNote={};MIDI.noteToKey={};(function(){for(var a="C Db D Eb E F Gb G Ab A Bb B".split(" "),b=21;108>=b;b++){var f=a[b%12]+((b-12)/12>>0);MIDI.keyToNote[f]=b;MIDI.noteToKey[b]=f}})()})();"undefined"===typeof MIDI&&(MIDI={});"undefined"===typeof MIDI.Player&&(MIDI.Player={}); (function(){var a=MIDI.Player;a.callback=void 0;a.currentTime=0;a.endTime=0;a.restart=0;a.playing=!1;a.timeWarp=1;a.start=a.resume=function(){-1>a.currentTime&&(a.currentTime=-1);q(a.currentTime)};a.pause=function(){var b=a.restart;r();a.restart=b};a.stop=function(){r();a.restart=0;a.currentTime=0};a.addListener=function(a){d=a};a.removeListener=function(){d=void 0};a.clearAnimation=function(){a.interval&&window.clearInterval(a.interval)};a.setAnimation=function(b){var c="function"===typeof b?b:b.callback; b=b.interval||30;var d=0,f=0,h=0;a.clearAnimation();a.interval=window.setInterval(function(){if(0!==a.endTime){a.playing?(d=h===a.currentTime?f-(new Date).getTime():0,d=0===a.currentTime?0:a.currentTime-d,h!==a.currentTime&&(f=(new Date).getTime(),h=a.currentTime)):d=a.currentTime;var b=d/1E3,k=b/60,b=60*k+(b-60*k),k=a.endTime/1E3;-1>k-b||c({now:b,end:k,events:e})}},b)};a.loadMidiFile=function(){a.replayer=new Replayer(MidiFile(a.currentData),a.timeWarp);a.data=a.replayer.getData();a.endTime=g()}; a.loadFile=function(b,c){a.stop();if(-1!==b.indexOf("base64,")){var d=window.atob(b.split(",")[1]);a.currentData=d;a.loadMidiFile();c&&c(d)}else d=new XMLHttpRequest,d.open("GET",b),d.overrideMimeType("text/plain; charset=x-user-defined"),d.onreadystatechange=function(){if(4===this.readyState&&200===this.status){for(var b=this.responseText||"",d=[],e=b.length,f=String.fromCharCode,k=0;k<e;k++)d[k]=f(b.charCodeAt(k)&255);b=d.join("");a.currentData=b;a.loadMidiFile();c&&c(b)}},d.send()};var c=[],b, f=0,e={},d=void 0,l=function(c,f,h,g,l,r){return window.setTimeout(function(){var g={channel:c,note:f,now:h,end:a.endTime,message:l,velocity:r};128===l?delete e[f]:e[f]=g;d&&d(g);a.currentTime=h;a.currentTime===b&&b<a.endTime&&q(b,!0)},h-g)},h=function(){if("WebAudioAPI"===MIDI.lang)return MIDI.Player.ctx;a.ctx||(a.ctx={currentTime:0});return a.ctx},g=function(){for(var b=a.data,c=b.length,d=.5,e=0;e<c;e++)d+=b[e][1];return d},q=function(d,e){if(a.replayer){e||("undefined"===typeof d&&(d=a.restart), a.playing&&r(),a.playing=!0,a.data=a.replayer.getData(),a.endTime=g());var m,n=0,p=0,q=a.data,w=h(),x=q.length;b=.5;f=w.currentTime;for(var v=0;v<x&&100>p;v++)if(b+=q[v][1],b<d)n=b;else{d=b-n;var s=q[v][0].event;if("channel"===s.type){var u=s.channel;switch(s.subtype){case "noteOn":if(MIDI.channels[u].mute)break;m=s.noteNumber-(a.MIDIOffset||0);c.push({event:s,source:MIDI.noteOn(u,s.noteNumber,s.velocity,d/1E3+w.currentTime),interval:l(u,m,b,n,144,s.velocity)});p++;break;case "noteOff":if(MIDI.channels[u].mute)break; m=s.noteNumber-(a.MIDIOffset||0);c.push({event:s,source:MIDI.noteOff(u,s.noteNumber,d/1E3+w.currentTime),interval:l(u,m,b,n,128)})}}}}},r=function(){var b=h();a.playing=!1;for(a.restart+=1E3*(b.currentTime-f);c.length;)b=c.pop(),window.clearInterval(b.interval),b.source&&("number"===typeof b.source?window.clearTimeout(b.source):b.source.disconnect(0));for(var g in e)b=e[g],144===e[g].message&&d&&d({channel:b.channel,note:b.note,now:b.now,end:b.end,message:128,velocity:b.velocity});e={}}})(); if("undefined"===typeof DOMLoader)var DOMLoader={};if("undefined"===typeof XMLHttpRequest){var XMLHttpRequest;(function(){for(var a=[function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0;c<a.length;c++){try{a[c]()}catch(b){continue}break}XMLHttpRequest=a[c]})()} if("undefined"===typeof(new XMLHttpRequest).responseText){var IEBinaryToArray_ByteStr_Script="\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\n<script type='text/vbscript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n Dim lastIndex\r\n lastIndex = LenB(Binary)\r\n if lastIndex mod 2 Then\r\n IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n Else\r\n IEBinaryToArray_ByteStr_Last = \"\"\r\n End If\r\nEnd Function\r\n\x3c/script>\r\n";document.write(IEBinaryToArray_ByteStr_Script); DOMLoader.sendRequest=function(a){function c(a){for(var b={},d=0;256>d;d++)for(var c=0;256>c;c++)b[String.fromCharCode(d+256*c)]=String.fromCharCode(d)+String.fromCharCode(c);d=IEBinaryToArray_ByteStr(a);a=IEBinaryToArray_ByteStr_Last(a);return d.replace(/[\s\S]/g,function(a){return b[a]})+a}var b=XMLHttpRequest();b.open("GET",a.url,!0);a.responseType&&(b.responseType=a.responseType);a.onerror&&(b.onerror=a.onerror);a.onprogress&&(b.onprogress=a.onprogress);b.onreadystatechange=function(f){if(4=== b.readyState&&(200===b.status?b.responseText=c(b.responseBody):b=!1,a.onload))a.onload(b)};b.setRequestHeader("Accept-Charset","x-user-defined");b.send(null);return b}}else DOMLoader.sendRequest=function(a){var c=new XMLHttpRequest;c.open(a.data?"POST":"GET",a.url,!0);c.overrideMimeType&&c.overrideMimeType("text/plain; charset=x-user-defined");a.data&&c.setRequestHeader("Content-type","application/x-www-form-urlencoded");a.responseType&&(c.responseType=a.responseType);a.onerror&&(c.onerror=a.onerror); a.onprogress&&(c.onprogress=a.onprogress);c.onreadystatechange=function(b){if(4===c.readyState)if(200!==c.status&&304!=c.status){if(a.onerror)a.onerror(b,!1)}else if(a.onload)a.onload(c)};c.send(a.data);return c};